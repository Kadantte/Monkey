These codes come from https://github.com/JialianW/GRiT.git.